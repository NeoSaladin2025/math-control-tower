<!DOCTYPE html>
<html lang="ko">
<head>
    <link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
    <link rel="icon" href="favicon.ico" type="image/x-icon">
    
    <link rel="manifest" href="site.webmanifest">
    
    <link rel="apple-touch-icon" href="favicon.ico">
    <meta charset="UTF-8">
    <title>ì‹œì¦Œ ê´€ë¦¬ ì»¨íŠ¸ë¡¤ íƒ€ì›Œ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Black+Han+Sans&family=Orbitron:wght@900&family=Rubik+Glitch&family=Cinzel:wght@900&family=Bangers&display=swap" rel="stylesheet">
    
    <style>
        body { font-family: 'Pretendard', sans-serif; background-color: #f8fafc; padding: 2rem; user-select: none; }
        
        .tab-btn { padding: 12px 24px; font-weight: 800; color: #94a3b8; border-bottom: 3px solid transparent; transition: all 0.2s; cursor: pointer; white-space: nowrap; }
        .tab-btn:hover { color: #6366f1; }
        .tab-btn.active { color: #4f46e5; border-bottom-color: #4f46e5; }
        .custom-scroll::-webkit-scrollbar { width: 6px; }
        .custom-scroll::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 3px; }

        /* --- â˜… V13.5 CHAOS ENGINE CSS (Viewer Port) â˜… --- */
        .emblem-stage-container { perspective: 1000px; overflow: visible !important; z-index: 20; }
        
        /* Layer & Effects Stacking System */
        .obj-root { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); display: flex; align-items: center; justify-content: center; width: 0; height: 0; }
        .effect-wrapper { position: absolute; display: flex; align-items: center; justify-content: center; transform-style: preserve-3d; will-change: transform, filter; width: 0; height: 0; }
        .obj-orbit, .obj-spin { position: absolute; display: flex; align-items: center; justify-content: center; transform-style: preserve-3d; will-change: transform; }
        .obj-core { position: relative; display: flex; align-items: center; justify-content: center; text-align: center; line-height: 1; white-space: nowrap; mix-blend-mode: normal; }
        .obj-core img { max-width: none; pointer-events: none; }

        /* V13.5 Animation Library */
        @keyframes heartbeat { 0% {transform: scale(1);} 14% {transform: scale(1.3);} 28% {transform: scale(1);} 42% {transform: scale(1.3);} 70% {transform: scale(1);} }
        @keyframes rubberBand { 0% {transform: scale3d(1,1,1);} 30% {transform: scale3d(1.25,0.75,1);} 40% {transform: scale3d(0.75,1.25,1);} 50% {transform: scale3d(1.15,0.85,1);} 65% {transform: scale3d(0.95,1.05,1);} 75% {transform: scale3d(1.05,0.95,1);} 100% {transform: scale3d(1,1,1);} }
        @keyframes swing { 20% {transform: rotate3d(0,0,1,15deg);} 40% {transform: rotate3d(0,0,1,-10deg);} 60% {transform: rotate3d(0,0,1,5deg);} 80% {transform: rotate3d(0,0,1,-5deg);} 100% {transform: rotate3d(0,0,1,0deg);} }
        @keyframes tada { 0% {transform: scale3d(1,1,1);} 10%, 20% {transform: scale3d(0.9,0.9,0.9) rotate3d(0,0,1,-3deg);} 30%, 50%, 70%, 90% {transform: scale3d(1.1,1.1,1.1) rotate3d(0,0,1,3deg);} 40%, 60%, 80% {transform: scale3d(1.1,1.1,1.1) rotate3d(0,0,1,-3deg);} 100% {transform: scale3d(1,1,1);} }
        @keyframes wobble { 0% {transform: none} 15% {transform: translate3d(-25%,0,0) rotate3d(0,0,1,-5deg)} 30% {transform: translate3d(20%,0,0) rotate3d(0,0,1,3deg)} 45% {transform: translate3d(-15%,0,0) rotate3d(0,0,1,-3deg)} 60% {transform: translate3d(10%,0,0) rotate3d(0,0,1,2deg)} 75% {transform: translate3d(-5%,0,0) rotate3d(0,0,1,-1deg)} 100% {transform: none} }
        @keyframes jello { 0%,11.1%,to {transform:translateZ(0)} 22.2% {transform:skewX(-12.5deg) skewY(-12.5deg)} 33.3% {transform:skewX(6.25deg) skewY(6.25deg)} 44.4% {transform:skewX(-3.125deg) skewY(-3.125deg)} 55.5% {transform:skewX(1.5625deg) skewY(1.5625deg)} 66.6% {transform:skewX(-.78125deg) skewY(-.78125deg)} 77.7% {transform:skewX(.390625deg) skewY(.390625deg)} 88.8% {transform:skewX(-.1953125deg) skewY(-.1953125deg)} }
        @keyframes bounce { 0%, 20%, 53%, 80%, 100% {transform: translate3d(0,0,0);} 40%, 43% {transform: translate3d(0, -30px, 0);} 70% {transform: translate3d(0, -15px, 0);} 90% {transform: translate3d(0,-4px,0);} }
        @keyframes flip { from {transform: perspective(400px) scale3d(1, 1, 1) translate3d(0, 0, 0) rotate3d(0, 1, 0, -360deg);} 40%, 50% {transform: perspective(400px) scale3d(1, 1, 1) translate3d(0, 0, 0) rotate3d(0, 1, 0, -190deg);} 80% {transform: perspective(400px) scale3d(0.95, 0.95, 0.95) translate3d(0, 0, 0) rotate3d(0, 1, 0, 0deg);} 100% {transform: perspective(400px) scale3d(1, 1, 1) translate3d(0, 0, 0) rotate3d(0, 1, 0, 0deg);} }
        @keyframes zoomInOut { 0% {transform: scale(1);} 50% {transform: scale(1.5);} 100% {transform: scale(1);} }
        @keyframes panic { 0% {transform: translate(0,0) rotate(0deg);} 25% {transform: translate(5px,5px) rotate(5deg);} 50% {transform: translate(0,0) rotate(0eg);} 75% {transform: translate(-5px,5px) rotate(-5deg);} 100% {transform: translate(0,0) rotate(0deg);} }
        @keyframes breath { 0% {transform: scale(1);} 50% {transform: scale(1.05);} 100% {transform: scale(1);} }
        @keyframes barrel { 0% {transform: rotateX(0deg);} 100% {transform: rotateX(360deg);} }
        @keyframes compress { 0% {transform: scaleY(1);} 50% {transform: scaleY(0.5);} 100% {transform: scaleY(1);} }
        @keyframes blackHole { 0% {transform: scale(1) rotate(0deg);} 50% {transform: scale(0.1) rotate(180deg); opacity: 0.5;} 100% {transform: scale(1) rotate(360deg); opacity: 1;} }
        @keyframes tornado { 0% {transform: translateX(-50px) rotateY(0deg);} 50% {transform: translateX(50px) rotateY(180deg) scale(1.2);} 100% {transform: translateX(-50px) rotateY(360deg);} }
        @keyframes teleport { 0% {opacity:1; transform: scale(1);} 49% {opacity:1; transform: scale(0.1);} 50% {opacity:0; transform: scale(0.1);} 51% {opacity:0; transform: scale(1.5);} 52% {opacity:1; transform: scale(1);} 100% {opacity:1;} }
        @keyframes orbit3d { 0% {transform: rotate3d(1,1,1,0deg);} 100% {transform: rotate3d(1,1,1,360deg);} }
        @keyframes glitch-skew { 0% {transform: skew(0deg);} 20% {transform: skew(-10deg);} 40% {transform: skew(10deg);} 60% {transform: skew(-5deg);} 80% {transform: skew(5deg);} 100% {transform: skew(0deg);} }
        @keyframes vibrate { 0% {transform: translate(0);} 20% {transform: translate(-2px, 2px);} 40% {transform: translate(-2px, -2px);} 60% {transform: translate(2px, 2px);} 80% {transform: translate(2px, -2px);} 100% {transform: translate(0);} }
        @keyframes float-h { 0%, 100% { transform: translateX(0); } 50% { transform: translateX(-20px); } }
        @keyframes pendulum { 0% { transform: rotate(20deg); } 50% { transform: rotate(-20deg); } 100% { transform: rotate(20deg); } }

        /* FX */
        @keyframes fire { 0% { filter: drop-shadow(0 0 2px orangered); } 50% { filter: drop-shadow(0 -5px 5px yellow); } 100% { filter: drop-shadow(0 0 2px orangered); } }
        @keyframes sparkle { 0% { filter: brightness(100%); } 50% { filter: brightness(150%) drop-shadow(0 0 5px white); } 100% { filter: brightness(100%); } }
        @keyframes neon-pulse { 0% { filter: drop-shadow(0 0 2px cyan); } 50% { filter: drop-shadow(0 0 10px magenta); } 100% { filter: drop-shadow(0 0 2px cyan); } }
        @keyframes shake { 0% { transform: translate(0,0); } 25% { transform: translate(2px, -2px); } 50% { transform: translate(-2px, 2px); } 75% { transform: translate(2px, 2px); } 100% { transform: translate(0,0); } }
        @keyframes glitch-filter { 0% { clip-path: inset(50% 0 30% 0); transform: translate(-5px,0); } 100% { clip-path: inset(0 0 0 0); transform: translate(0); } }
        @keyframes rainbow { 0% { filter: hue-rotate(0deg); } 100% { filter: hue-rotate(360deg); } }
        @keyframes blurPulse { 0% { filter: blur(0px); } 50% { filter: blur(4px); } 100% { filter: blur(0px); } }
        @keyframes invertFlash { 0% { filter: invert(0%); } 50% { filter: invert(100%); } 100% { filter: invert(0%); } }
        @keyframes sepiaDream { 0% { filter: sepia(0%); } 50% { filter: sepia(100%); } 100% { filter: sepia(0%); } }
        @keyframes brightnessFlash { 0% { filter: brightness(1); } 50% { filter: brightness(3) drop-shadow(0 0 10px white); } 100% { filter: brightness(1); } }
        @keyframes grayscalePulse { 0% { filter: grayscale(0%); } 50% { filter: grayscale(100%); } 100% { filter: grayscale(0%); } }
        @keyframes radioactive { 0% { filter: drop-shadow(0 0 2px lime); } 50% { filter: drop-shadow(0 0 10px #0f0) hue-rotate(90deg); } 100% { filter: drop-shadow(0 0 2px lime); } }
        @keyframes ice { 0% { filter: drop-shadow(0 0 2px cyan) hue-rotate(180deg) brightness(1.2); } 100% { filter: drop-shadow(0 0 5px white) hue-rotate(180deg) brightness(1.2); } }
        @keyframes shadowClone { 0% { filter: drop-shadow(5px 5px 0px rgba(0,0,0,0.5)); } 50% { filter: drop-shadow(-5px -5px 0px rgba(255,0,0,0.5)); } 100% { filter: drop-shadow(5px 5px 0px rgba(0,0,0,0.5)); } }
        @keyframes midas { 0% { filter: sepia(1) saturate(5) brightness(1); } 50% { filter: sepia(1) saturate(5) brightness(1.5) drop-shadow(0 0 5px gold); } 100% { filter: sepia(1) saturate(5) brightness(1); } }
        @keyframes matrix { 0% { filter: drop-shadow(0 0 2px #0f0) hue-rotate(0deg) contrast(1.5); } 50% { filter: drop-shadow(0 0 5px #0f0) hue-rotate(20deg) contrast(2); } 100% { filter: drop-shadow(0 0 2px #0f0) hue-rotate(0deg) contrast(1.5); } }
        @keyframes thermal { 0% { filter: contrast(1.5) hue-rotate(0deg); } 50% { filter: contrast(2) hue-rotate(180deg) invert(1); } 100% { filter: contrast(1.5) hue-rotate(360deg); } }
        @keyframes hologram { 0% { filter: drop-shadow(0 0 2px cyan) opacity(0.8); } 20% { filter: drop-shadow(2px 0 5px cyan) opacity(0.6) blur(1px); } 40% { filter: drop-shadow(-2px 0 5px cyan) opacity(0.8); } 100% { filter: drop-shadow(0 0 2px cyan) opacity(0.8); } }
        @keyframes noir { 0% { filter: grayscale(1) contrast(1.5) brightness(0.8); } 100% { filter: grayscale(1) contrast(2) brightness(0.6); } }
        @keyframes pixelate { 0% { filter: contrast(1); } 50% { filter: contrast(3) brightness(1.2); } 100% { filter: contrast(1); } }
        @keyframes underwater { 0% { filter: blur(1px) hue-rotate(180deg) brightness(0.8); } 50% { filter: blur(2px) hue-rotate(200deg) brightness(1); } 100% { filter: blur(1px) hue-rotate(180deg) brightness(0.8); } }

        @keyframes orbit-cw { from { transform: rotate(0deg) translateX(var(--orbit-r)) rotate(0deg); } to { transform: rotate(360deg) translateX(var(--orbit-r)) rotate(-360deg); } }
        @keyframes spin-z { from { transform: rotateZ(0deg); } to { transform: rotateZ(360deg); } }
        @keyframes spin-y { from { transform: rotateY(0deg); } to { transform: rotateY(360deg); } }
        @keyframes spin-x { from { transform: rotateX(0deg); } to { transform: rotateX(360deg); } }

        #preview-modal { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.8); z-index: 100; backdrop-filter: blur(5px); justify-content: center; align-items: center; }
        .student-card-preview { background: white; width: 400px; padding: 24px; border-radius: 24px; box-shadow: 0 20px 50px rgba(0,0,0,0.3); position: relative; overflow: visible; }
        
        .tier-card { transition: all 0.2s; border: 2px solid transparent; }
        .tier-card:hover { transform: translateY(-2px); }
        .tier-card.selected { border-color: #6366f1; background: #e0e7ff; }
        .tier-card.selected .tier-icon { background: #6366f1; color: white; }

        .insert-zone { height: 24px; display: flex; align-items: center; justify-content: center; opacity: 0; transition: opacity 0.2s; cursor: pointer; margin: 4px 0; position: relative; }
        .insert-zone:hover { opacity: 1; }
        .insert-line { position: absolute; width: 100%; height: 2px; background: #e0e7ff; z-index: 0; }
        .plus-circle { width: 24px; height: 24px; background: #4f46e5; color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: bold; font-size: 14px; box-shadow: 0 2px 4px rgba(79, 70, 229, 0.4); z-index: 1; transform: scale(0.8); transition: transform 0.2s; }
        .insert-zone:hover .plus-circle { transform: scale(1.1); }
        .xp-input { background: transparent; border-bottom: 2px solid #cbd5e1; text-align: center; font-family: monospace; font-weight: bold; width: 80px; transition: 0.2s; }
        .xp-input:focus { outline: none; border-color: #4f46e5; color: #4f46e5; }
    </style>
</head>
<body>
    <script src="config.js"></script>

    <div class="max-w-7xl mx-auto">
        <div class="flex justify-between items-end mb-6">
            <div>
                <h2 class="text-3xl font-black text-slate-800 flex items-center gap-2">
                    <i class="fa-solid fa-trophy text-amber-500"></i> ì‹œì¦Œ ê´€ë¦¬ ì»¨íŠ¸ë¡¤ íƒ€ì›Œ
                </h2>
                <p class="text-sm text-slate-500 mt-2 font-bold">í˜„ì¬ ì‹œì¦Œ: <span id="current-season-display" class="text-indigo-600">ë¡œë”© ì¤‘...</span> <span id="status-badge" class="px-2 py-0.5 rounded text-[10px] bg-slate-200 text-slate-500">UNKNOWN</span></p>
            </div>
        </div>

        <div class="flex border-b border-slate-200 mb-8 overflow-x-auto pb-1">
            <button onclick="switchTab('control')" class="tab-btn active" id="tab-control">âš™ï¸ ì‹œì¦Œ í†µì œì‹¤</button>
            <button onclick="switchTab('tier')" class="tab-btn" id="tab-tier">ğŸ“Š ì‹œì¦Œ í‹°ì–´ ê´€ë¦¬</button>
            <button onclick="switchTab('users')" class="tab-btn" id="tab-users">ğŸ‘¥ ì‹œì¦Œ ì°¸ì—¬ì</button>
            <button onclick="switchTab('emblem')" class="tab-btn text-pink-600 font-black" id="tab-emblem">ğŸ¨ ì— ë¸”ëŸ¼ ì œì‘ & ë°°í¬</button>
            <button onclick="switchTab('event')" class="tab-btn" id="tab-event">ğŸ‰ í‹°ì–´ ì´ë²¤íŠ¸</button>
            <button onclick="switchTab('notice')" class="tab-btn" id="tab-notice">ğŸ“¢ ì‹œì¦Œ ê³µì§€</button>
            
            <button onclick="openAwardPrep()" class="tab-btn text-emerald-600 font-bold" id="tab-award-prep">ğŸ› ï¸ ì‹œìƒì‹ ì¤€ë¹„</button>
            
            <div class="tooltip-wrap">
                <button onclick="openAwardPopup()" class="tab-btn" id="tab-award">ğŸ† ì‹œìƒì‹ (ì¢…ë£Œ í›„)</button>
            </div>
        </div>

        <div id="view-control" class="tab-view animate-fade-in">
            <div class="grid grid-cols-2 gap-8">
                <div class="bg-white p-8 rounded-2xl border border-indigo-100 shadow-lg relative overflow-hidden">
                    <div class="absolute top-0 right-0 p-4 opacity-10"><i class="fa-solid fa-play text-9xl text-indigo-500"></i></div>
                    <h3 class="text-xl font-bold text-slate-800 mb-4">ğŸš€ ìƒˆ ì‹œì¦Œ ì‹œì‘</h3>
                    <p class="text-sm text-slate-500 mb-6">ì „êµìƒì˜ 'ì‹œì¦Œ XP'ê°€ 0ìœ¼ë¡œ ì´ˆê¸°í™”ë©ë‹ˆë‹¤.</p>
                    <div class="flex gap-2">
                        <input type="text" id="new-season-name" placeholder="ì˜ˆ: 2025 Spring Season" class="flex-1 bg-slate-50 border rounded-xl px-4 py-3 font-bold focus:border-indigo-500 outline-none">
                        <button onclick="startSeason()" class="bg-indigo-600 hover:bg-indigo-700 text-white px-6 py-3 rounded-xl font-bold shadow-lg active:scale-95 transition">ì‹œì‘</button>
                    </div>
                </div>
                <div class="bg-white p-8 rounded-2xl border border-red-100 shadow-lg relative overflow-hidden">
                    <div class="absolute top-0 right-0 p-4 opacity-10"><i class="fa-solid fa-lock text-9xl text-red-500"></i></div>
                    <h3 class="text-xl font-bold text-slate-800 mb-4">ğŸ”’ ì‹œì¦Œ ì¢…ë£Œ</h3>
                    <p class="text-sm text-slate-500 mb-6">ì‹œì¦Œì„ ì¢…ë£Œí•˜ê³  ë°ì´í„°ë¥¼ ë™ê²°í•©ë‹ˆë‹¤.</p>
                    <button onclick="endSeasonStep1()" id="btn-end-season" class="w-full bg-slate-800 hover:bg-slate-900 text-white py-4 rounded-xl font-bold shadow-lg transition">ì‹œì¦Œ ì¢…ë£Œ (ì ê¸ˆ)</button>
                </div>
            </div>
        </div>

        <div id="view-tier" class="tab-view hidden">
            <div class="bg-white p-8 rounded-2xl shadow-sm border border-slate-200">
                <div class="flex justify-between items-center mb-8">
                    <h3 class="font-black text-slate-800 text-xl">ë“±ê¸‰ë³„ XP êµ¬ê°„ ì„¤ì •</h3>
                    <button onclick="verifyTiers()" class="bg-slate-100 text-slate-600 px-4 py-2 rounded-lg font-bold hover:bg-slate-200 shadow-sm transition">ê²€ì¦</button>
                </div>
                <div id="tier-list-container" class="space-y-1 mb-8"></div>
                <button onclick="saveTiers()" id="btn-save-tier" class="w-full py-4 bg-indigo-600 text-white rounded-xl font-bold shadow-lg hover:bg-indigo-700 disabled:opacity-50 disabled:cursor-not-allowed transition" disabled>ê²€ì¦ì´ í•„ìš”í•©ë‹ˆë‹¤</button>
            </div>
        </div>

        <div id="view-users" class="tab-view hidden">
            <div class="bg-white p-10 rounded-2xl shadow-sm border border-slate-200 text-center relative overflow-hidden group hover:border-indigo-300 transition">
                <div class="w-20 h-20 bg-indigo-50 rounded-full flex items-center justify-center text-4xl mx-auto mb-6 group-hover:scale-110 transition duration-500">ğŸ‘¥</div>
                <h3 class="text-2xl font-black text-slate-800 mb-2">ì‹œì¦Œ ì°¸ì—¬ì & ì‹¬íŒ ê´€ë¦¬</h3>
                <button onclick="window.open('manager_season_users.html', '_blank', 'width=1000,height=800')" class="bg-slate-800 hover:bg-black text-white px-8 py-4 rounded-2xl font-bold shadow-xl active:scale-95 mx-auto">ê´€ë¦¬ì†Œ ì…ì¥í•˜ê¸°</button>
            </div>
        </div>

        <div id="view-emblem" class="tab-view hidden">
            <div class="bg-slate-900 rounded-2xl p-6 mb-6 flex justify-between items-center shadow-lg relative overflow-hidden">
                <div class="absolute inset-0 bg-[url('https://www.transparenttextures.com/patterns/stardust.png')] opacity-20"></div>
                <div class="relative z-10">
                    <h3 class="text-xl font-black text-white flex items-center gap-2">
                        <i class="fa-solid fa-industry text-pink-500"></i> ì— ë¸”ëŸ¼ ì œì‘ì†Œ (Factory)
                    </h3>
                    <p class="text-xs text-slate-400 mt-1">ìƒˆë¡œìš´ ë””ìì¸ì„ ì—°êµ¬í•˜ê³  ì €ì¥ê³ ì— ë³´ê´€í•˜ì„¸ìš”.</p>
                </div>
                <button onclick="openEmblemEditor()" class="relative z-10 bg-gradient-to-r from-pink-600 to-purple-600 text-white px-6 py-3 rounded-xl font-bold shadow-lg hover:scale-105 transition">
                    <i class="fa-solid fa-hammer mr-2"></i> ì œì‘ì†Œ ì…ì¥í•˜ê¸°
                </button>
            </div>

            <div class="flex gap-6 h-[700px]">
                <div class="w-1/3 bg-white p-6 rounded-2xl shadow-sm border border-slate-200 flex flex-col">
                    <h4 class="font-bold text-slate-700 mb-4 border-b pb-2 flex items-center gap-2">
                        <span class="bg-slate-800 text-white w-6 h-6 rounded-full flex items-center justify-center text-xs">1</span>
                        í‹°ì–´ ì„ íƒ (Target Tier)
                    </h4>
                    <div id="tier-select-list" class="flex-1 overflow-y-auto custom-scroll space-y-2 pr-2"><div class="text-center py-10"><div class="loader"></div></div></div>
                </div>

                <div class="flex-1 bg-white p-6 rounded-2xl shadow-sm border border-slate-200 flex flex-col relative">
                    <h4 class="font-bold text-slate-700 mb-4 border-b pb-2 flex justify-between items-center">
                        <span class="flex items-center gap-2">
                            <span class="bg-pink-600 text-white w-6 h-6 rounded-full flex items-center justify-center text-xs">2</span>
                            ë³´ê´€í•¨ (Repository)
                        </span>
                        <div id="target-indicator" class="text-xs font-bold text-slate-400">íƒ€ê²Ÿ ë¯¸ì„ íƒ</div>
                    </h4>
                    <div id="lock-screen" class="absolute inset-0 top-14 bg-white/90 z-20 flex flex-col items-center justify-center text-slate-400 backdrop-blur-sm rounded-b-2xl">
                        <i class="fa-solid fa-arrow-left text-4xl mb-4 animate-pulse"></i>
                        <span class="font-bold">ì™¼ìª½ì—ì„œ í‹°ì–´ë¥¼ ë¨¼ì € ì„ íƒí•˜ì„¸ìš”.</span>
                    </div>
                    <div id="library-list" class="flex-1 overflow-y-auto custom-scroll grid grid-cols-2 gap-3 pb-4"></div>
                </div>
            </div>
        </div>

        <div id="view-event" class="tab-view hidden"><div class="bg-white p-10 rounded-2xl shadow-sm text-center">Coming Soon</div></div>
        <div id="view-notice" class="tab-view hidden"><div class="bg-white p-6 rounded-2xl shadow-sm"><textarea id="notice-content" class="w-full h-32 border rounded p-4 mb-2"></textarea><button onclick="saveNotice()" class="bg-indigo-600 text-white px-4 py-2 rounded">ì „ì†¡</button></div></div>
        <div id="view-award" class="tab-view hidden"><div class="bg-white p-6 rounded-2xl shadow-sm">ì‹œìƒì‹ ì¤€ë¹„ì¤‘</div></div>
    </div>

    <div id="preview-modal">
        <div class="student-card-preview group">
            <button onclick="document.getElementById('preview-modal').style.display='none'" class="absolute top-4 right-4 text-slate-300 hover:text-slate-500 z-50"><i class="fa-solid fa-xmark text-xl"></i></button>
            <div class="absolute top-0 right-0 p-10 opacity-5 pointer-events-none z-0"><i class="fa-solid fa-crown text-9xl"></i></div>
            
            <div class="flex justify-between items-start relative z-10 mb-4">
                <div>
                    <div class="flex items-center gap-2">
                        <h2 class="text-2xl font-black text-slate-800">ê¹€í•™ìƒ</h2>
                        <span class="bg-slate-100 text-slate-500 text-[10px] px-2 py-0.5 rounded-full font-bold border border-slate-200">Preview</span>
                    </div>
                    <p class="text-xs font-bold text-slate-400 mt-1"><i class="fa-solid fa-layer-group"></i> Total Lv.99</p>
                </div>
                <div class="text-right">
                    <div class="text-[10px] font-bold text-indigo-400 uppercase tracking-wider">Target Tier</div>
                    <div class="font-black text-slate-800" id="preview-tier-name">Gold</div>
                </div>
            </div>

            <div class="relative w-full h-48 flex items-center justify-center my-2 z-20 emblem-stage-container">
                <div id="preview-stage" class="w-40 h-40 relative flex items-center justify-center transition-transform hover:scale-110 duration-500"></div>
            </div>

            <div class="relative z-10">
                <div class="flex justify-between items-end mb-2">
                    <span class="text-xs font-bold text-slate-400">Next Tier</span>
                    <div class="text-right"><span class="text-lg font-black text-indigo-600">750</span> XP</div>
                </div>
                <div class="w-full h-3 bg-slate-100 rounded-full overflow-hidden shadow-inner">
                    <div class="h-full bg-gradient-to-r from-indigo-500 via-purple-500 to-pink-500 w-[75%]"></div>
                </div>
            </div>
        </div>
    </div>

    <script>
        let currentSeason = null;
        let tiers = [];
        let selectedTierName = null;
        let libraryDataCache = [];

        function switchTab(id) {
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            document.querySelectorAll('.tab-view').forEach(v => v.classList.add('hidden'));
            document.getElementById(`tab-${id}`).classList.add('active');
            document.getElementById(`view-${id}`).classList.remove('hidden');
            if(id === 'emblem') loadEmblemTab();
        }

        async function init() {
            // [â˜… ìˆ˜ì •] maybeSingle() ì‚¬ìš© (status ì •ë³´ë„ ê°€ì ¸ì˜´)
            const { data: seasons } = await _supabase.from('seasons').select('*').eq('is_current', true).maybeSingle();
            currentSeason = seasons;
            if(seasons) document.getElementById('current-season-display').innerText = seasons.season_name;
            else document.getElementById('current-season-display').innerText = "ì—†ìŒ";

            // [â˜… ìˆ˜ì •] ì‹œì¦Œì´ ì¢…ë£Œëœ ìƒíƒœë©´ ì‹œìƒì‹ ë²„íŠ¼ í™œì„±í™” ì‹œê° íš¨ê³¼
            if (seasons && seasons.status === 'ended') {
                const awardBtn = document.getElementById('tab-award');
                awardBtn.classList.remove('text-gray-400');
                awardBtn.classList.add('text-amber-500', 'animate-pulse');
            }

            const { data: tr } = await _supabase.from('tier_rules').select('*').order('min_xp');
            tiers = tr || [];
            renderTiers(); 
        }

        function openEmblemEditor() { window.open('editor_emblem.html', '_blank', 'width=1400,height=900,left=100,top=50'); }

        async function startSeason() {
            const nameInput = document.getElementById('new-season-name');
            const seasonName = nameInput.value.trim();
            if (!seasonName) return alert("ì‹œì¦Œ ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.");
            const { data: activeSeason } = await _supabase.from('seasons').select('*').eq('is_current', true).maybeSingle();
            // í™œì„± ì‹œì¦Œ(active)ì´ ìˆìœ¼ë©´ ì‹œì‘ ë¶ˆê°€
            if (activeSeason && activeSeason.status === 'active') return alert("ğŸš« í˜„ì¬ ì§„í–‰ ì¤‘ì¸ ì‹œì¦Œì´ ìˆìŠµë‹ˆë‹¤!\n\në¨¼ì € [ì‹œì¦Œ ì¢…ë£Œ]ë¥¼ ëˆŒëŸ¬ ì •ì‚°ì„ ì™„ë£Œí•´ì£¼ì„¸ìš”.");
            
            if (!confirm(`[${seasonName}]ì„(ë¥¼) ì‹œì‘í•˜ì‹œê² ìŠµë‹ˆê¹Œ?\n\nì£¼ì˜: ëª¨ë“  í•™ìƒì˜ 'ì‹œì¦Œ XP'ê°€ 0ìœ¼ë¡œ ì´ˆê¸°í™”ë©ë‹ˆë‹¤!`)) return;
            try {
                const { error: insertErr } = await _supabase.from('seasons').insert([{ season_name: seasonName, is_current: true, status: 'active' }]);
                if (insertErr) throw insertErr;
                const { error: updateErr } = await _supabase.from('users').update({ season_xp: 0 }).eq('role', 'student');
                if (updateErr) throw updateErr;
                alert(`ğŸ‰ [${seasonName}]ì´ ì„±ê³µì ìœ¼ë¡œ ì‹œì‘ë˜ì—ˆìŠµë‹ˆë‹¤!`);
                location.reload();
            } catch (e) { console.error(e); alert("ì‹œì¦Œ ì‹œì‘ ì‹¤íŒ¨: " + e.message); }
        }

        function renderTiers() {
            const container = document.getElementById('tier-list-container');
            container.innerHTML = '';
            if (tiers.length === 0) tiers.push({ tier_name: 'Bronze', min_xp: 0, max_xp: 1000 });
            tiers.forEach((t, index) => {
                container.innerHTML += getInsertBtn(index);
                container.innerHTML += `<div class="flex items-center gap-4 bg-slate-50 p-4 rounded-xl border border-slate-200 shadow-sm relative group hover:border-indigo-300 transition"><div class="w-8 h-8 rounded-full bg-white border flex items-center justify-center font-bold text-slate-400 shadow-sm">${index + 1}</div><input type="text" value="${t.tier_name}" class="bg-transparent font-black text-lg w-32 outline-none border-b-2 border-transparent focus:border-indigo-500 focus:text-indigo-600 transition" onchange="updTier(${index}, 'tier_name', this.value)"><div class="flex items-center gap-2 text-sm font-bold text-slate-500"><input type="number" value="${t.min_xp}" class="xp-input" onchange="updTier(${index}, 'min_xp', this.value)"><span>~</span><input type="number" value="${t.max_xp}" class="xp-input" onchange="updTier(${index}, 'max_xp', this.value)"><span>XP</span></div><button onclick="delTier(${index})" class="ml-auto text-slate-300 hover:text-red-500 transition px-2"><i class="fa-solid fa-trash"></i></button></div>`;
            });
            container.innerHTML += getInsertBtn(tiers.length);
        }

        function getInsertBtn(index) { return `<div class="insert-zone" onclick="addTier(${index})"><div class="insert-line"></div><div class="plus-circle">+</div></div>`; }
        function addTier(index) { const prevMax = index > 0 ? Number(tiers[index - 1].max_xp) : 0; const newTier = { tier_name: 'New Tier', min_xp: prevMax + 1, max_xp: prevMax + 1000 }; tiers.splice(index, 0, newTier); renderTiers(); disableSaveBtn(); }
        function delTier(index) { if(!confirm("ì´ í‹°ì–´ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) return; tiers.splice(index, 1); renderTiers(); disableSaveBtn(); }
        function updTier(index, key, value) { if (key === 'min_xp' || key === 'max_xp') value = Number(value); tiers[index][key] = value; disableSaveBtn(); }
        function verifyTiers() {
            let isValid = true; let errorMsg = "";
            for (let i = 0; i < tiers.length; i++) { const t = tiers[i]; if (Number(t.min_xp) >= Number(t.max_xp)) { errorMsg = `[${i + 1}ë²ˆ: ${t.tier_name}] ìµœì†Œê°’ì´ ìµœëŒ€ê°’ë³´ë‹¤ í¬ê±°ë‚˜ ê°™ìŠµë‹ˆë‹¤.`; isValid = false; break; } }
            if (isValid) { for (let i = 0; i < tiers.length - 1; i++) { const currentMax = Number(tiers[i].max_xp); const nextMin = Number(tiers[i+1].min_xp); if (currentMax >= nextMin) { errorMsg = `[êµ¬ê°„ ê²¹ì¹¨] ${tiers[i].tier_name}ì™€ ${tiers[i+1].tier_name} êµ¬ê°„ ì¶©ëŒ.`; isValid = false; break; } } }
            if (isValid) { alert("âœ… ê²€ì¦ ì™„ë£Œ! ì €ì¥ ë²„íŠ¼ì´ í™œì„±í™”ë˜ì—ˆìŠµë‹ˆë‹¤."); enableSaveBtn(); } else { alert("âŒ ê²€ì¦ ì‹¤íŒ¨:\n" + errorMsg); disableSaveBtn(); }
        }
        function disableSaveBtn() { const btn = document.getElementById('btn-save-tier'); btn.disabled = true; btn.classList.add('opacity-50', 'cursor-not-allowed'); btn.innerText = "ê²€ì¦ì´ í•„ìš”í•©ë‹ˆë‹¤"; }
        function enableSaveBtn() { const btn = document.getElementById('btn-save-tier'); btn.disabled = false; btn.classList.remove('opacity-50', 'cursor-not-allowed'); btn.innerText = "ì €ì¥ ë° ì ìš©"; }
        async function saveTiers() {
            if(!confirm("í‹°ì–´ ì„¤ì •ì„ ì €ì¥í•˜ê³  ì ìš©í•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) return;
            const { error: delErr } = await _supabase.from('tier_rules').delete().neq('id', 0); 
            if(delErr) return alert("ì´ˆê¸°í™” ì‹¤íŒ¨: " + delErr.message);
            const payload = tiers.map((t, idx) => { const { id, created_at, ...rest } = t; return { ...rest, min_xp: Number(rest.min_xp), max_xp: Number(rest.max_xp), order_index: idx + 1 }; });
            const { error: insErr } = await _supabase.from('tier_rules').insert(payload);
            if(insErr) alert("ì €ì¥ ì‹¤íŒ¨: " + insErr.message); else { alert("âœ… í‹°ì–´ ì„¤ì • ì €ì¥ ì™„ë£Œ."); location.reload(); }
        }

        async function loadEmblemTab() {
            const { data: tr } = await _supabase.from('tier_rules').select('*').order('min_xp');
            tiers = tr || [];
            renderTierSelectList();
            const { data: lib } = await _supabase.from('emblem_library').select('*').order('created_at', { ascending: false });
            libraryDataCache = lib || [];
            renderLibraryList(libraryDataCache);
        }

        function renderTierSelectList() {
            const container = document.getElementById('tier-select-list');
            container.innerHTML = '';
            tiers.forEach(t => {
                const isSelected = t.tier_name === selectedTierName;
                const div = document.createElement('div');
                div.className = `tier-card bg-slate-50 p-4 rounded-xl border border-slate-200 cursor-pointer flex items-center justify-between group ${isSelected ? 'selected' : ''}`;
                div.onclick = () => selectTargetTier(t.tier_name);
                let emblemId = `tier-preview-${t.tier_name}`;
                div.innerHTML = `<div class="flex items-center gap-4"><div class="tier-icon w-12 h-12 rounded-full bg-white border border-slate-200 flex items-center justify-center font-black text-slate-300 shadow-sm relative overflow-hidden group-hover:scale-110 transition"><div id="${emblemId}" class="absolute inset-0 flex items-center justify-center"></div></div><div><div class="font-black text-slate-700 text-lg group-hover:text-indigo-600 transition">${t.tier_name}</div><div class="text-[10px] text-slate-400 font-bold">${t.min_xp.toLocaleString()} ~ ${t.max_xp.toLocaleString()} XP</div></div></div><div class="text-slate-300 group-hover:text-indigo-500"><i class="fa-solid fa-chevron-right"></i></div>`;
                container.appendChild(div);
                // â˜… V13.5 Render Call
                if(t.emblem_json && t.emblem_json.layers) setTimeout(() => renderEmblem(emblemId, t.emblem_json.layers, 0.25), 0);
                else document.getElementById(emblemId).innerHTML = `<span class="text-[10px]">${t.tier_name[0]}</span>`;
            });
        }

        function selectTargetTier(tierName) {
            selectedTierName = tierName;
            renderTierSelectList(); 
            document.getElementById('lock-screen').classList.add('hidden');
            document.getElementById('target-indicator').innerHTML = `Target: <span class="text-indigo-600 font-black text-lg underline">${tierName}</span>`;
        }

        function renderLibraryList(lib) {
            const container = document.getElementById('library-list');
            container.innerHTML = '';
            if(!lib || lib.length === 0) { container.innerHTML = '<div class="col-span-2 text-center py-10 text-slate-400 text-sm">ë³´ê´€í•¨ì´ ë¹„ì—ˆìŠµë‹ˆë‹¤.</div>'; return; }
            lib.forEach(item => {
                const div = document.createElement('div');
                div.className = "bg-white p-3 rounded-xl border border-slate-200 shadow-sm hover:border-pink-300 hover:shadow-md transition flex flex-col gap-2 group";
                const prevId = `lib-prev-${item.id}`;
                div.innerHTML = `<div class="flex items-center gap-3"><div class="w-14 h-14 bg-slate-50 rounded-lg border border-slate-100 relative overflow-hidden flex items-center justify-center"><div id="${prevId}" class="absolute inset-0 flex items-center justify-center"></div></div><div class="flex-1 min-w-0"><div class="font-bold text-slate-700 text-sm truncate group-hover:text-pink-600">${item.name}</div><div class="text-[10px] text-slate-400">${new Date(item.created_at).toLocaleDateString()}</div></div></div><div class="flex gap-2"><button onclick="previewLibraryItem('${item.id}')" class="px-3 py-2 bg-slate-100 text-slate-600 rounded-lg hover:bg-slate-200 font-bold text-xs transition" title="ë¯¸ë¦¬ë³´ê¸°"><i class="fa-solid fa-eye"></i></button><button onclick="applyEmblemToTier('${item.id}')" class="flex-1 bg-slate-100 text-slate-600 hover:bg-pink-500 hover:text-white py-2 rounded-lg text-xs font-bold transition">ì´ê±¸ë¡œ ì ìš©í•˜ê¸°</button></div>`;
                container.appendChild(div);
                // â˜… V13.5 Render Call
                if(item.layers) setTimeout(() => renderEmblem(prevId, item.layers, 0.3), 0);
            });
        }

        function previewLibraryItem(libId) {
            const item = libraryDataCache.find(x => x.id === libId);
            if(!item) return;
            document.getElementById('preview-tier-name').innerText = selectedTierName || "Preview";
            document.getElementById('preview-modal').style.display = 'flex';
            // â˜… V13.5 Render Call
            renderEmblem('preview-stage', item.layers, 0.45); 
        }

        async function applyEmblemToTier(libId) {
            if(!selectedTierName) return alert("ì™¼ìª½ì—ì„œ ì ìš©í•  í‹°ì–´ë¥¼ ë¨¼ì € ì„ íƒí•˜ì„¸ìš”.");
            const { data: item } = await _supabase.from('emblem_library').select('*').eq('id', libId).single();
            if(!item) return;
            if(!confirm(`[${selectedTierName}] í‹°ì–´ì˜ ì— ë¸”ëŸ¼ì„\n'${item.name}'(ìœ¼)ë¡œ ì¦‰ì‹œ êµì²´í•˜ì‹œê² ìŠµë‹ˆê¹Œ?`)) return;
            // V13.5 í˜¸í™˜ ë°ì´í„° êµ¬ì¡° ì €ì¥
            const { error } = await _supabase.from('tier_rules').update({ emblem_json: { mode: 'v13.5', layers: item.layers } }).eq('tier_name', selectedTierName);
            if(error) alert("ì‹¤íŒ¨: " + error.message); else { alert(`âœ… [${selectedTierName}] ì—…ë°ì´íŠ¸ ì™„ë£Œ!`); loadEmblemTab(); }
        }

        // --- â˜… [V13.5 CORE] CHAOS ALCHEMIST RENDERER â˜… ---
        // V7 ë Œë”ëŸ¬ íê¸° -> V13.5 ë Œë”ëŸ¬ ì´ì‹ ì™„ë£Œ
        function renderEmblem(containerId, layers, scaleFactor=0.4) {
            const stage = document.getElementById(containerId);
            if(!stage) return;
            stage.innerHTML = ''; 
            
            // ë ˆì´ì–´ ìˆœì„œëŒ€ë¡œ ë Œë”ë§ (DOM Order = Z-Index)
            layers.forEach(l => {
                const root = document.createElement('div');
                root.className = 'obj-root';
                root.style.left = '50%'; root.style.top = '50%'; // ì¤‘ì•™ ì •ë ¬ ë³´ì •

                // 1. Orbit
                const orbit = document.createElement('div'); orbit.className = 'obj-orbit';
                if(l.anim.orbit.on) { 
                    orbit.style.setProperty('--orbit-r', `${l.anim.orbit.radius * scaleFactor}px`); 
                    orbit.style.animation = `orbit-cw ${l.anim.orbit.speed/5}s linear infinite`; 
                }

                // 2. Vital Stack (ë‹¤ì¤‘ íš¨ê³¼ ì§€ì›)
                let currentContainer = orbit;
                if(l.anim.vital && l.anim.vital.length > 0) {
                    // êµ¬í˜• ë°ì´í„°(ë¬¸ìì—´ ë°°ì—´) í˜¸í™˜ ì²˜ë¦¬
                    let vitals = typeof l.anim.vital[0] === 'string' ? l.anim.vital.map(t=>({type:t, speed:10})) : l.anim.vital;
                    vitals.forEach(e => {
                        const wrapper = document.createElement('div'); wrapper.className = 'effect-wrapper';
                        const speed = (21 - (e.speed || 10)) / 10;
                        wrapper.style.animation = `${e.type} ${speed}s infinite ease-in-out`;
                        currentContainer.appendChild(wrapper); currentContainer = wrapper;
                    });
                } else if(l.anim.vital && l.anim.vital.on) { // V7 ë°ì´í„° í˜¸í™˜
                     const wrapper = document.createElement('div'); wrapper.className = 'effect-wrapper';
                     wrapper.style.animation = `${l.anim.vital.type} ${l.anim.vital.speed/10}s infinite ease-in-out`;
                     currentContainer.appendChild(wrapper); currentContainer = wrapper;
                }

                // 3. FX Stack (ë‹¤ì¤‘ íš¨ê³¼ ì§€ì›)
                if(l.anim.fx && l.anim.fx.length > 0) {
                    let fxs = typeof l.anim.fx[0] === 'string' ? l.anim.fx.map(t=>({type:t, speed:10})) : l.anim.fx;
                    fxs.forEach(e => {
                        const wrapper = document.createElement('div'); wrapper.className = 'effect-wrapper';
                        const speed = (21 - (e.speed || 10)) / 10;
                        wrapper.style.animation = `${e.type} ${speed}s infinite`;
                        currentContainer.appendChild(wrapper); currentContainer = wrapper;
                    });
                } else if(l.anim.fx && l.anim.fx.on) { // V7 ë°ì´í„° í˜¸í™˜
                     const wrapper = document.createElement('div'); wrapper.className = 'effect-wrapper';
                     wrapper.style.animation = `${l.anim.fx.type} ${l.anim.fx.speed/10}s infinite`;
                     currentContainer.appendChild(wrapper); currentContainer = wrapper;
                }

                // 4. Spin
                const spin = document.createElement('div'); spin.className = 'obj-spin';
                if(l.anim.spin.on) { spin.style.animation = `spin-${l.anim.spin.axis} ${l.anim.spin.speed/5}s linear infinite`; }
                currentContainer.appendChild(spin);

                // 5. Core
                const core = document.createElement('div'); core.className = 'obj-core';
                
                // â˜… V13.5 Features: Blend, Opacity, Backdrop
                if(l.style.blendMode) core.style.mixBlendMode = l.style.blendMode;
                if(l.style.opacity !== undefined) core.style.opacity = l.style.opacity;
                if(l.style.backdropFilter && l.style.backdropFilter !== 'none') core.style.backdropFilter = l.style.backdropFilter;

                if (l.type === 'image') {
                    const img = document.createElement('img'); img.src = l.content;
                    img.style.width = `${l.style.size * scaleFactor}px`; img.style.height = 'auto';
                    core.appendChild(img);
                } else {
                    core.style.fontSize = `${l.style.size * scaleFactor}px`;
                    if(l.style.texture !== 'none') {
                        core.style.color='transparent'; core.style.backgroundClip='text'; core.style.webkitBackgroundClip='text';
                        if(l.style.texture==='gold') core.style.backgroundImage='linear-gradient(135deg, #fef08a, #d97706)';
                        else if(l.style.texture==='magma') core.style.backgroundImage='linear-gradient(0deg, #ef4444, #000)';
                        else if(l.style.texture==='silver') core.style.backgroundImage='linear-gradient(135deg, #e2e8f0, #64748b)';
                        else if(l.style.texture==='neon') core.style.backgroundImage='linear-gradient(90deg, #22d3ee, #a855f7)';
                    } else { core.style.color = l.style.color; }
                    
                    if(l.type==='icon') core.innerHTML = `<i class="${l.content}"></i>`; 
                    else if(l.type==='text') { core.innerText = l.content; core.style.fontFamily = "'Black Han Sans', sans-serif"; } 
                    else core.innerText = l.content;
                }
                
                spin.appendChild(core); root.appendChild(orbit); stage.appendChild(root);
            });
        }

        // [â˜… NEW] ì‹œìƒì‹ íŒì—… ì—´ê¸°
        function openAwardPopup() {
            if (!currentSeason || currentSeason.status !== 'ended') {
                alert("âš ï¸ ì‹œì¦Œì´ ì•„ì§ ì¢…ë£Œë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.\n[ì‹œì¦Œ ì¢…ë£Œ] ë²„íŠ¼ì„ ëˆŒëŸ¬ ë§ˆê° í›„ ì…ì¥í•´ì£¼ì„¸ìš”.");
                return;
            }
            // íŒì—… ì—´ê¸° (íŒŒì¼ëª…: manager_season_award.html)
            window.open('manager_season_award.html', '_blank', 'width=1200,height=900');
        }

        // [â˜… NEW] ì‹œìƒì‹ ì¤€ë¹„ íŒì—… ì—´ê¸°
        function openAwardPrep() {
            // íŒì—… ì—´ê¸° (íŒŒì¼ëª…: manager_season_award_prep.html)
            window.open('manager_season_award_prep.html', '_blank', 'width=1200,height=900');
        }

        // [â˜… NEW] ì‹œì¦Œ ì¢…ë£Œ ë¡œì§ êµ¬í˜„
        async function endSeasonStep1() {
            if (!currentSeason) return alert("ì§„í–‰ ì¤‘ì¸ ì‹œì¦Œì´ ì—†ìŠµë‹ˆë‹¤.");
            if (currentSeason.status === 'ended') return alert("ì´ë¯¸ ì¢…ë£Œëœ ì‹œì¦Œì…ë‹ˆë‹¤. ì‹œìƒì‹ì„ ì§„í–‰í•˜ì„¸ìš”.");
            
            if (!confirm("ì •ë§ ì‹œì¦Œì„ ì¢…ë£Œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?\n\n1. ëª¨ë“  ë°ì´í„°ê°€ ë™ê²°ë©ë‹ˆë‹¤.\n2. ì‹œìƒì‹ íƒ­ì´ í™œì„±í™”ë©ë‹ˆë‹¤.")) return;

            // DB Update
            const { error } = await _supabase.from('seasons')
                .update({ status: 'ended' })
                .eq('id', currentSeason.id);

            if (error) {
                alert("ì˜¤ë¥˜: " + error.message);
            } else {
                alert("âœ… ì‹œì¦Œì´ ì¢…ë£Œë˜ì—ˆìŠµë‹ˆë‹¤! ì‹œìƒì‹ ì…ì¥ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤.");
                location.reload();
            }
        }

        async function saveNotice() { /*...*/ }

        init();
    </script>
</body>
</html>